<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Divine Yazatas | Zoroastrian Heritage</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;600;800&family=Lato:wght@300;400;700&family=Noto+Naskh+Arabic:wght@500;700&display=swap" rel="stylesheet">

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        'cinzel': ['Cinzel', 'serif'],
                        'lato': ['Lato', 'sans-serif'],
                        'persian': ['Noto Naskh Arabic', 'serif'],
                    },
                    colors: {
                        'persian-gold': '#D4AF37',
                        'persian-blue': '#1a5f7a',
                        'deep-rose': '#be123c',
                        'royal-purple': '#7e22ce',
                        'sand': '#fdfcf8',
                    }
                }
            }
        }
    </script>

    <style>
        body {
            background-color: #fdfcf8;
            background-image: 
                linear-gradient(rgba(212, 175, 55, 0.03) 1px, transparent 1px),
                linear-gradient(90deg, rgba(212, 175, 55, 0.03) 1px, transparent 1px);
            background-size: 40px 40px;
        }
        
        /* Smooth Fade In */
        .fade-in { animation: fadeIn 0.5s ease-in-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 10px; }
        ::-webkit-scrollbar-thumb:hover { background: #94a3b8; }

        /* Gender Gradients for Card Borders */
        .border-gradient-male { background: linear-gradient(to right, #0ea5e9, #2563eb); }
        .border-gradient-female { background: linear-gradient(to right, #fb7185, #e11d48); }
        .border-gradient-neutral { background: linear-gradient(to right, #fbbf24, #d97706); }
        .border-gradient-plural { background: linear-gradient(to right, #c084fc, #9333ea); }
    </style>
</head>
<body class="font-lato text-gray-700 min-h-screen flex flex-col antialiased">

    <!-- Hero / Header -->
    <header class="sticky top-0 z-50 transition-all duration-300 backdrop-blur-md bg-white/80 border-b border-stone-200 shadow-sm">
        <div class="h-1 w-full bg-gradient-to-r from-transparent via-persian-gold to-transparent opacity-70"></div>
        <div class="container mx-auto px-6 py-4">
            <div class="flex flex-col md:flex-row justify-between items-center gap-5">
                
                <!-- Brand -->
                <div class="flex items-center gap-4 group cursor-default">
                    <div class="relative">
                        <div class="absolute -inset-1 rounded-full bg-gradient-to-r from-amber-300 to-orange-400 opacity-30 blur group-hover:opacity-50 transition duration-500"></div>
                        <div class="relative w-12 h-12 bg-white rounded-full flex items-center justify-center border border-amber-100 shadow-sm">
                            <i class="fa-solid fa-fire text-amber-600 text-xl"></i>
                        </div>
                    </div>
                    <div>
                        <h1 class="text-2xl font-cinzel font-bold text-gray-800 tracking-wide uppercase">Yazatas</h1>
                        <p class="text-[10px] text-amber-700 font-bold uppercase tracking-[0.2em]">Zoroastrian Divinity</p>
                    </div>
                </div>
                
                <!-- Search -->
                <div class="relative w-full md:w-96 group">
                    <div class="absolute -inset-0.5 rounded-full bg-gradient-to-r from-gray-200 to-gray-300 opacity-50 blur transition duration-300 group-hover:opacity-75 group-focus-within:opacity-100 group-focus-within:from-amber-300 group-focus-within:to-orange-300"></div>
                    <div class="relative bg-white rounded-full flex items-center shadow-sm">
                        <i class="fa-solid fa-search text-gray-400 ml-4"></i>
                        <input type="text" id="searchInput" placeholder="Search by name, role, or meaning..." 
                               class="w-full px-4 py-2.5 rounded-full bg-transparent focus:outline-none text-gray-700 placeholder-gray-400 text-sm">
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Section -->
    <main class="container mx-auto px-4 py-8 flex-grow">
        
        <!-- Tabs Navigation -->
        <div class="flex justify-center mb-10">
            <div class="bg-white/60 backdrop-blur-sm p-1.5 rounded-full shadow-inner border border-stone-100 inline-flex overflow-x-auto max-w-full space-x-1" id="categoryContainer">
                <!-- Tabs injected JS -->
            </div>
        </div>

        <!-- Description -->
        <div id="categoryDescription" class="mb-10 max-w-3xl mx-auto text-center hidden fade-in">
            <div class="relative px-8 py-6 bg-white rounded-2xl shadow-sm border border-stone-100">
                <i class="fa-solid fa-quote-left absolute top-4 left-4 text-gray-100 text-3xl"></i>
                <p class="relative z-10 text-gray-600 italic font-serif text-lg leading-relaxed"></p>
                <i class="fa-solid fa-quote-right absolute bottom-4 right-4 text-gray-100 text-3xl"></i>
            </div>
        </div>

        <!-- Cards Grid -->
        <div id="cardsGrid" class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-8">
            <!-- Cards injected by JS -->
        </div>

        <!-- Empty State -->
        <div id="emptyState" class="hidden text-center py-24 fade-in">
            <div class="inline-block p-6 rounded-full bg-gray-50 mb-4">
                <i class="fa-solid fa-scroll text-4xl text-gray-300"></i>
            </div>
            <h3 class="text-xl text-gray-500 font-cinzel font-semibold">No divinities found in the archives.</h3>
            <p class="text-gray-400 text-sm mt-2">Try adjusting your search terms.</p>
        </div>

    </main>

    <!-- Pagination -->
    <div class="bg-white/80 backdrop-blur border-t border-stone-200 py-6 mt-auto">
        <div class="container mx-auto px-4 flex justify-center items-center gap-6">
            <button id="prevBtn" class="group flex items-center gap-2 px-5 py-2.5 rounded-full bg-white border border-gray-200 text-gray-600 hover:border-amber-400 hover:text-amber-700 disabled:opacity-40 disabled:hover:border-gray-200 disabled:hover:text-gray-600 transition-all shadow-sm">
                <i class="fa-solid fa-arrow-left text-xs transition-transform group-hover:-translate-x-1"></i> 
                <span class="font-cinzel font-semibold text-sm">Previous</span>
            </button>
            
            <div class="flex items-center gap-2 font-cinzel text-gray-800 font-bold bg-amber-50 px-4 py-1 rounded-lg border border-amber-100">
                <span id="pageIndicator">1 / 1</span>
            </div>

            <button id="nextBtn" class="group flex items-center gap-2 px-5 py-2.5 rounded-full bg-white border border-gray-200 text-gray-600 hover:border-amber-400 hover:text-amber-700 disabled:opacity-40 disabled:hover:border-gray-200 disabled:hover:text-gray-600 transition-all shadow-sm">
                <span class="font-cinzel font-semibold text-sm">Next</span>
                <i class="fa-solid fa-arrow-right text-xs transition-transform group-hover:translate-x-1"></i>
            </button>
        </div>
    </div>

    <!-- Footer -->
    <footer class="bg-gray-900 text-gray-400 py-10 border-t-4 border-persian-gold">
        <div class="container mx-auto text-center space-y-4">
            <div class="flex justify-center gap-4 mb-4">
                <i class="fa-solid fa-star text-xs text-amber-700"></i>
                <i class="fa-solid fa-star text-sm text-amber-600"></i>
                <i class="fa-solid fa-star text-xs text-amber-700"></i>
            </div>
            <p class="text-sm font-cinzel tracking-wider text-gray-300">The Good Creation</p>
            <p class="text-xs opacity-50 font-lato">Honoring the heritage of Ancient Persia</p>
        </div>
    </footer>

    <!-- Logic -->
    <script>
        // --- 1. The Data ---
        const rawData = {
          "zoroastrian_yazatas": {
            "categories": [
              {
                "category_name": "The Creator & The Amesha Spentas",
                "description": "The Holy Immortals: These are the highest divinities, representing the aspects of God and guardians of the seven creations.",
                "entities": [
                  { "id": 1, "name": "Ahura Mazda", "alias": "Ormazd", "persian_script": "اهورامزدا", "gender": "Male (Father of All)", "meaning": "The Wise Lord", "role": "The Supreme Creator; Source of all good.", "guardian_of": "Mankind and the entire Good Creation." },
                  { "id": 2, "name": "Vohu Manah", "alias": "Bahman", "persian_script": "بهمن", "gender": "Male", "meaning": "Good Mind / Good Purpose", "role": "Protecting the animal kingdom; guiding the soul to paradise.", "guardian_of": "Cattle and beneficial animals." },
                  { "id": 3, "name": "Asha Vahishta", "alias": "Ardibehesht", "persian_script": "اردیبهشت", "gender": "Male", "meaning": "Best Truth / Best Righteousness", "role": "Upholding cosmic order and truth.", "guardian_of": "Fire (and by extension, energy)." },
                  { "id": 4, "name": "Khshathra Vairya", "alias": "Shahrivar", "persian_script": "شهریور", "gender": "Male", "meaning": "Desirable Dominion / Ideal Power", "role": "Represents the strength and power of the Kingdom of God; protector of the weak.", "guardian_of": "Metals and minerals (the sky was historically seen as made of hard stone/metal)." },
                  { "id": 5, "name": "Spenta Armaiti", "alias": "Sepandarma", "persian_script": "سپندارمذ", "gender": "Female", "meaning": "Holy Devotion / Serenity", "role": "Represents patient service and earthly fertility.", "guardian_of": "Earth." },
                  { "id": 6, "name": "Haurvatat", "alias": "Khordad", "persian_script": "خرداد", "gender": "Female", "meaning": "Wholeness / Perfection", "role": "Associated with health, prosperity, and fullness.", "guardian_of": "Water." },
                  { "id": 7, "name": "Ameretat", "alias": "Amordad", "persian_script": "امرداد", "gender": "Female", "meaning": "Immortality / Deathlessness", "role": "Represents eternal life and the preservation of life force.", "guardian_of": "Plants and vegetation." }
                ]
              },
              {
                "category_name": "The Calendar Yazatas",
                "description": "Lords of the Days: These Yazatas preside over the specific days of the Zoroastrian month (Siroza) and function as Hamkars (co-workers).",
                "entities": [
                  { "id": 8, "name": "Daepadar", "alias": "Day-be-Azar", "persian_script": "دی‌به‌آذر", "gender": "N/A (Aspect of the Creator)", "meaning": "Creator's Day (before Fire)", "role": "Represents the Creator's wisdom intervening in the second week.", "guardian_of": "Wisdom/Time." },
                  { "id": 9, "name": "Adar", "alias": "Azar", "persian_script": "آذر", "gender": "Male", "meaning": "Fire", "role": "The son of Ahura Mazda; the visible sign of God's presence.", "guardian_of": "All fires (hearth, ritual, internal heat)." },
                  { "id": 10, "name": "Aban (Aredvi Sura Anahita)", "alias": "Aban / Anahid", "persian_script": "آبان", "gender": "Female", "meaning": "The Waters", "role": "Purifier of the seed, womb, and milk; goddess of fertility.", "guardian_of": "All waters, rivers, and oceans." },
                  { "id": 11, "name": "Hvare Khshaeta", "alias": "Khorshid", "persian_script": "خورشید", "gender": "Male", "meaning": "The Shining Sun", "role": "The eye of Ahura Mazda; dispels darkness and pollution.", "guardian_of": "The Sun and solar energy." },
                  { "id": 12, "name": "Mah", "alias": "Mah", "persian_script": "ماه", "gender": "Male (Tradition)", "meaning": "The Moon", "role": "Keeper of the seed of the Bull; regulates tides and growth.", "guardian_of": "The Moon and gravitational cycles." },
                  { "id": 13, "name": "Tishtrya", "alias": "Tir", "persian_script": "تیر", "gender": "Male", "meaning": "The Star Sirius", "role": "Rainmaker; battles the demon of drought (Apaosha).", "guardian_of": "Rain and the star Sirius." },
                  { "id": 14, "name": "Geush Urvan", "alias": "Gosh", "persian_script": "گوش", "gender": "Female/Neutral", "meaning": "Soul of the Cow (Creation)", "role": "Represents the welfare of animals and the cry of the innocent.", "guardian_of": "Cattle and livestock." },
                  { "id": 15, "name": "Daepamehr", "alias": "Day-be-Mehr", "persian_script": "دی‌به‌مهر", "gender": "N/A (Aspect of the Creator)", "meaning": "Creator's Day (before Mithra)", "role": "Represents the Creator preceding the day of Covenant.", "guardian_of": "Divine Law." },
                  { "id": 16, "name": "Mithra", "alias": "Mehr", "persian_script": "مهر", "gender": "Male", "meaning": "Covenant / Contract", "role": "Judge of the soul at death; lord of wide pastures and light.", "guardian_of": "Promises, contracts, and the light of dawn." },
                  { "id": 17, "name": "Sraosha", "alias": "Soroush", "persian_script": "سروش", "gender": "Male", "meaning": "Obedience / Hearkening", "role": "Messenger of God; protects the soul for three days after death.", "guardian_of": "Prayer and the hearing of the divine word." },
                  { "id": 18, "name": "Rashnu", "alias": "Rashn", "persian_script": "رشن", "gender": "Male", "meaning": "Justice", "role": "The impartial judge who weighs the deeds of the souls.", "guardian_of": "Truth and justice (The Scales)." },
                  { "id": 19, "name": "Fravashis", "alias": "Farvardin", "persian_script": "فروردین", "gender": "Neutral/Plural", "meaning": "Guardian Spirits", "role": "The pre-existing souls of all living beings; they sustain the sky and earth.", "guardian_of": "Ancestors and the unborn." },
                  { "id": 20, "name": "Verethragna", "alias": "Bahram", "persian_script": "بهرام", "gender": "Male", "meaning": "Victory", "role": "The warrior god who grants triumph over evil; appears in 10 forms.", "guardian_of": "Victory and travelers." },
                  { "id": 21, "name": "Raman", "alias": "Ram", "persian_script": "رام", "gender": "Male", "meaning": "Peace / Joy", "role": "Associated with Vayu (Wind); brings the breath of life and tranquility.", "guardian_of": "Joy, peace, and the atmosphere." },
                  { "id": 22, "name": "Vata", "alias": "Govad / Bad", "persian_script": "باد", "gender": "Male", "meaning": "Wind", "role": "The physical wind that brings rain and moves the waters.", "guardian_of": "The wind and air." },
                  { "id": 23, "name": "Daepadin", "alias": "Day-be-Din", "persian_script": "دی‌به‌دین", "gender": "N/A (Aspect of the Creator)", "meaning": "Creator's Day (before Religion)", "role": "Represents the Creator preceding the day of Religion.", "guardian_of": "Spiritual choice." },
                  { "id": 24, "name": "Daena", "alias": "Din", "persian_script": "دین", "gender": "Female", "meaning": "Religion / Conscience", "role": "The personification of the inner self and religious insight.", "guardian_of": "The conscience and the Holy Religion." },
                  { "id": 25, "name": "Ashi Vanguhi", "alias": "Ard", "persian_script": "ارد", "gender": "Female", "meaning": "Good Reward / Blessing", "role": "Distributes the rewards of good deeds; associated with wealth.", "guardian_of": "Fortune and rewards." },
                  { "id": 26, "name": "Arshtat", "alias": "Ashtad", "persian_script": "اشتاد", "gender": "Female", "meaning": "Rectitude / Justice", "role": "Keeps the world in motion through truth; guide of the world.", "guardian_of": "Honesty and physical stability." },
                  { "id": 27, "name": "Asman", "alias": "Asman", "persian_script": "آسمان", "gender": "Male", "meaning": "Sky", "role": "The firmament that protects the earth.", "guardian_of": "The sky and the celestial sphere." },
                  { "id": 28, "name": "Zam", "alias": "Zamyad", "persian_script": "زامیاد", "gender": "Female", "meaning": "Earth / Land", "role": "Represents the physical land and the spirit of the earth's geography.", "guardian_of": "The land and soil." },
                  { "id": 29, "name": "Manthra Spenta", "alias": "Mahraspand", "persian_script": "ماراسپند", "gender": "Male", "meaning": "Holy Word", "role": "The power of the spoken prayer that defeats evil.", "guardian_of": "Holy texts and prayers." },
                  { "id": 30, "name": "Anaghra Raocha", "alias": "Aneran", "persian_script": "انارام", "gender": "Neutral", "meaning": "Endless Light", "role": "Represents the station of God and the infinite light of paradise.", "guardian_of": "Illumination and the highest heaven." }
                ]
              },
              {
                "category_name": "Extra-Calendar & Conceptual",
                "description": "These entities are invoked in specific prayers, Yashts, or as companions (Hamkars) to the main calendar deities.",
                "entities": [
                  { "id": 31, "name": "Apam Napat", "alias": "Borz / Barz-Izad", "persian_script": "برزیزد", "gender": "Male", "meaning": "Grandson of Waters", "role": "A great Ahuric divinity; shares the title 'Ahura'. Protector of the Glory.", "guardian_of": "Deep waters and sovereignty." },
                  { "id": 32, "name": "Haoma", "alias": "Hom", "persian_script": "هوم", "gender": "Male", "meaning": "The Pressed One", "role": "The priest of the Yazatas; represents health, strength, and ecstasy.", "guardian_of": "The Haoma plant and healing rituals." },
                  { "id": 33, "name": "Drvaspa", "alias": "Darvasp", "persian_script": "درواسپ", "gender": "Female", "meaning": "Mistress of Healthy Horses", "role": "Protector of herds and domestic animals.", "guardian_of": "Horses and livestock health." },
                  { "id": 34, "name": "Vanant", "alias": "Vanant", "persian_script": "ونند", "gender": "Male", "meaning": "The Conqueror (Star Vega)", "role": "Guardian of the West; assists Tishtrya in battling evil.", "guardian_of": "The Western horizon." },
                  { "id": 35, "name": "Satavaesa", "alias": "Satavay", "persian_script": "سدویس", "gender": "Male", "meaning": "The Hundred-Servants", "role": "Guardian of the South; distributes rain water.", "guardian_of": "The Southern horizon and rain distribution." },
                  { "id": 36, "name": "Haptoiranga", "alias": "Haftorang", "persian_script": "هفت‌اورنگ", "gender": "Male", "meaning": "Seven Signs (Big Dipper)", "role": "Guardian of the North; commander of stars against demonic planets.", "guardian_of": "The Northern horizon." },
                  { "id": 37, "name": "Chisti", "alias": "Chist", "persian_script": "چیستا", "gender": "Female", "meaning": "Insight / Knowledge", "role": "Guide of the path; associated with Daena (Religion).", "guardian_of": "Wisdom and clear vision." },
                  { "id": 38, "name": "Parendi", "alias": "Parend", "persian_script": "پارند", "gender": "Female", "meaning": "Abundance / Plenitude", "role": "Companion of Ashi; brings wealth and activity.", "guardian_of": "Hidden treasures and prosperity." },
                  { "id": 39, "name": "Nairyosangha", "alias": "Narsang", "persian_script": "نریوسنگ", "gender": "Male", "meaning": "Manly Utterance", "role": "Divine messenger; lights the fire of Kings.", "guardian_of": "The link between men and gods (fire)." },
                  { "id": 40, "name": "Airyaman", "alias": "Erman", "persian_script": "اریامن", "gender": "Male", "meaning": "Friendship", "role": "The Yazata of healing and marriage; invoked for cures.", "guardian_of": "Healing, marriage, and social bonds." },
                  { "id": 41, "name": "Dahman", "alias": "Dahm", "persian_script": "دهم", "gender": "Male/Neutral", "meaning": "Prayer", "role": "Personification of the prayers of the congregation.", "guardian_of": "The power of communal worship." },
                  { "id": 42, "name": "Burz", "alias": "Burz", "persian_script": "برز", "gender": "Female/Male aspects", "meaning": "Exalted / High", "role": "The divinity of agriculture and water.", "guardian_of": "Crops and fertility." },
                  { "id": 43, "name": "Ushah", "alias": "Ushbami", "persian_script": "اوش‌بام", "gender": "Female", "meaning": "Dawn", "role": "The goddess of dawn; drives away the demons of night.", "guardian_of": "The morning light and intellect." },
                  { "id": 44, "name": "Zrebar", "alias": "Zare", "persian_script": "زره", "gender": "N/A (Abstract)", "meaning": "Ocean / Sea", "role": "Often personified in relation to the mythic Vourukasha sea.", "guardian_of": "The mythical source of all waters." },
                  { "id": 45, "name": "Thwasha", "alias": "Thwasha", "persian_script": "ثواشا", "gender": "Male", "meaning": "Space / Firmament", "role": "The infinite space in which the luminaries move.", "guardian_of": "The atmosphere." },
                  { "id": 46, "name": "Zurvan", "alias": "Zaman", "persian_script": "زمان", "gender": "Male/Neutral", "meaning": "Time", "role": "The boundless time in which Ahura Mazda creates.", "guardian_of": "Destiny and cycles." },
                  { "id": 47, "name": "Akhshti", "alias": "Ashti", "persian_script": "آشتی", "gender": "Female", "meaning": "Peace", "role": "Companion of Vohu Manah; opposes discord.", "guardian_of": "Peace and reconciliation." },
                  { "id": 48, "name": "Hamvareti", "alias": "Ham-vereti", "persian_script": "همورتی", "gender": "Female", "meaning": "Courage / Valor", "role": "Often invoked alongside Vanant and Verethragna.", "guardian_of": "Bravery in defense." },
                  { "id": 49, "name": "Iza", "alias": "Izeh", "persian_script": "ایزه", "gender": "Female", "meaning": "Zeal / Devotion", "role": "Represents the religious zeal of the worshiper.", "guardian_of": "Sacrifice and religious fervor." },
                  { "id": 50, "name": "Khvarenah", "alias": "Farr / Farrah", "persian_script": "فر / فره", "gender": "Neutral", "meaning": "Divine Glory", "role": "The divine luminous energy that legitimizes kings and prophets.", "guardian_of": "Royal authority and destiny." }
                ]
              }
            ]
          }
        };

        // --- 2. State & Setup ---
        let currentCategory = 'All';
        let searchQuery = '';
        let currentPage = 1;
        const itemsPerPage = 9;
        
        let allEntities = [];
        const categories = rawData.zoroastrian_yazatas.categories;
        
        categories.forEach(cat => {
            cat.entities.forEach(ent => {
                allEntities.push({
                    ...ent,
                    categoryRef: cat.category_name
                });
            });
        });

        // --- 3. UI Helpers ---

        function getGenderTheme(gender) {
            const g = gender.toLowerCase();
            
            if (g.includes('plural')) {
                return {
                    borderClass: 'border-gradient-plural',
                    badgeBg: 'bg-purple-50',
                    badgeText: 'text-purple-700',
                    badgeBorder: 'border-purple-200',
                    icon: 'fa-users',
                    shadow: 'hover:shadow-purple-100'
                };
            }
            else if (g.includes('female')) {
                return {
                    borderClass: 'border-gradient-female',
                    badgeBg: 'bg-rose-50',
                    badgeText: 'text-rose-700',
                    badgeBorder: 'border-rose-200',
                    icon: 'fa-venus',
                    shadow: 'hover:shadow-rose-100'
                };
            } 
            else if (g.includes('male') && !g.includes('female')) { 
                return {
                    borderClass: 'border-gradient-male',
                    badgeBg: 'bg-sky-50',
                    badgeText: 'text-sky-700',
                    badgeBorder: 'border-sky-200',
                    icon: 'fa-mars',
                    shadow: 'hover:shadow-sky-100'
                };
            } 
            else {
                return {
                    borderClass: 'border-gradient-neutral',
                    badgeBg: 'bg-amber-50',
                    badgeText: 'text-amber-700',
                    badgeBorder: 'border-amber-200',
                    icon: 'fa-gem',
                    shadow: 'hover:shadow-amber-100'
                };
            }
        }

        function createCategoryTabs() {
            const container = document.getElementById('categoryContainer');
            
            // "All" Button
            const allBtn = document.createElement('button');
            allBtn.dataset.cat = 'All';
            allBtn.className = `px-5 py-2.5 rounded-full text-sm font-bold transition-all duration-300 font-cinzel ${currentCategory === 'All' ? 'bg-gray-800 text-white shadow-md' : 'bg-transparent text-gray-500 hover:bg-gray-100'}`;
            allBtn.textContent = 'All';
            allBtn.onclick = () => setCategory('All');
            container.appendChild(allBtn);

            // Category Buttons
            categories.forEach(cat => {
                const btn = document.createElement('button');
                btn.dataset.cat = cat.category_name;
                const isActive = currentCategory === cat.category_name;
                // Shorten name logic
                let displayName = cat.category_name;
                if(displayName.includes('Creator')) displayName = 'Amesha Spentas';
                if(displayName.includes('Calendar')) displayName = 'Calendar';
                if(displayName.includes('Extra')) displayName = 'Concepts';

                btn.className = `px-5 py-2.5 rounded-full text-sm font-bold transition-all duration-300 whitespace-nowrap font-cinzel ${isActive ? 'bg-persian-gold text-white shadow-md' : 'bg-transparent text-gray-500 hover:bg-gray-100'}`;
                btn.textContent = displayName;
                btn.onclick = () => setCategory(cat.category_name);
                container.appendChild(btn);
            });
        }

        // --- 4. Logic Functions ---

        function setCategory(catName) {
            currentCategory = catName;
            currentPage = 1;
            updateCategoryTabsUI();
            updateCategoryDescription();
            render();
        }

        function updateCategoryTabsUI() {
            const buttons = document.getElementById('categoryContainer').children;
            Array.from(buttons).forEach(btn => {
                if (btn.dataset.cat === currentCategory) {
                    btn.className = currentCategory === 'All' 
                        ? 'px-5 py-2.5 rounded-full text-sm font-bold transition-all duration-300 font-cinzel bg-gray-800 text-white shadow-md transform scale-105'
                        : 'px-5 py-2.5 rounded-full text-sm font-bold transition-all duration-300 whitespace-nowrap font-cinzel bg-persian-gold text-white shadow-md transform scale-105';
                } else {
                    btn.className = 'px-5 py-2.5 rounded-full text-sm font-bold transition-all duration-300 whitespace-nowrap font-cinzel bg-transparent text-gray-500 hover:bg-gray-50';
                }
            });
        }

        function updateCategoryDescription() {
            const descBox = document.getElementById('categoryDescription');
            const descText = descBox.querySelector('p');
            
            if (currentCategory === 'All' || searchQuery !== '') {
                descBox.classList.add('hidden');
                return;
            }
            
            const catData = categories.find(c => c.category_name === currentCategory);
            if (catData && catData.description) {
                descText.textContent = catData.description;
                descBox.classList.remove('hidden');
            }
        }

        function filterData() {
            let data = currentCategory === 'All' 
                ? allEntities 
                : allEntities.filter(e => e.categoryRef === currentCategory);

            if (searchQuery) {
                const lowerQ = searchQuery.toLowerCase();
                data = data.filter(e => 
                    e.name.toLowerCase().includes(lowerQ) ||
                    e.alias.toLowerCase().includes(lowerQ) ||
                    e.meaning.toLowerCase().includes(lowerQ) ||
                    e.role.toLowerCase().includes(lowerQ) ||
                    e.guardian_of.toLowerCase().includes(lowerQ)
                );
            }
            return data;
        }

        function renderCard(entity) {
            const theme = getGenderTheme(entity.gender);
            
            return `
            <div class="group relative bg-white rounded-2xl shadow-[0_4px_20px_rgb(0,0,0,0.03)] border border-stone-100 overflow-hidden flex flex-col h-full transition-all duration-300 hover:-translate-y-1 hover:shadow-xl ${theme.shadow} fade-in">
                
                <!-- Top Gradient Border -->
                <div class="h-1.5 w-full ${theme.borderClass}"></div>
                
                <div class="p-7 flex flex-col flex-grow relative z-10">
                    
                    <!-- Header -->
                    <div class="flex justify-between items-start mb-4">
                        <div class="flex-grow pr-4">
                            <span class="inline-flex items-center gap-1.5 px-2.5 py-0.5 rounded-md text-[10px] font-bold uppercase tracking-wider mb-3 border ${theme.badgeBg} ${theme.badgeText} ${theme.badgeBorder}">
                                <i class="fa-solid ${theme.icon}"></i> ${entity.gender.split(' ')[0]}
                            </span>
                            <h3 class="text-2xl font-cinzel font-bold text-gray-800 leading-none mb-1">${entity.name}</h3>
                            <p class="text-xs font-semibold text-gray-400 uppercase tracking-wide">aka ${entity.alias}</p>
                        </div>
                        <!-- Persian Script - Now clearly visible -->
                        <div class="text-2xl font-persian text-gray-400 group-hover:text-persian-gold transition-colors duration-300" dir="rtl">
                            ${entity.persian_script}
                        </div>
                    </div>
                    
                    <!-- Meaning -->
                    <div class="mb-5">
                        <p class="text-lg font-serif italic text-gray-600">"${entity.meaning}"</p>
                        <div class="w-12 h-0.5 bg-amber-200 mt-3 rounded-full"></div>
                    </div>

                    <!-- Details -->
                    <div class="space-y-3 text-sm text-gray-600 flex-grow leading-relaxed">
                        <div class="flex gap-2">
                            <i class="fa-solid fa-crown text-amber-600/70 mt-1 text-xs"></i>
                            <div><strong class="text-gray-900 block text-xs uppercase tracking-wide opacity-70 mb-0.5">Divine Role</strong>${entity.role}</div>
                        </div>
                        <div class="flex gap-2">
                            <i class="fa-solid fa-shield-halved text-amber-600/70 mt-1 text-xs"></i>
                            <div><strong class="text-gray-900 block text-xs uppercase tracking-wide opacity-70 mb-0.5">Guardian Of</strong>${entity.guardian_of}</div>
                        </div>
                    </div>
                </div>
                
                <!-- Footer strip -->
                <div class="bg-stone-50/50 px-6 py-3 border-t border-stone-100 flex justify-between items-center">
                   <span class="text-[10px] font-bold text-gray-400 uppercase tracking-widest">ID: ${String(entity.id).padStart(2, '0')}</span>
                   <i class="fa-solid fa-feather text-stone-200 group-hover:text-amber-400 transition-colors"></i>
                </div>
            </div>
            `;
        }

        function render() {
            const filtered = filterData();
            const grid = document.getElementById('cardsGrid');
            const emptyState = document.getElementById('emptyState');
            const pageIndicator = document.getElementById('pageIndicator');
            const prevBtn = document.getElementById('prevBtn');
            const nextBtn = document.getElementById('nextBtn');

            // Pagination
            const totalPages = Math.ceil(filtered.length / itemsPerPage) || 1;
            
            if (currentPage > totalPages) currentPage = totalPages;
            if (currentPage < 1) currentPage = 1;

            const startIndex = (currentPage - 1) * itemsPerPage;
            const endIndex = startIndex + itemsPerPage;
            const pageData = filtered.slice(startIndex, endIndex);

            // Render Grid
            grid.innerHTML = '';
            
            if (filtered.length === 0) {
                emptyState.classList.remove('hidden');
                grid.classList.add('hidden');
            } else {
                emptyState.classList.add('hidden');
                grid.classList.remove('hidden');
                pageData.forEach(entity => {
                    grid.innerHTML += renderCard(entity);
                });
            }

            // Controls
            pageIndicator.textContent = `${currentPage} / ${totalPages}`;
            prevBtn.disabled = currentPage === 1;
            nextBtn.disabled = currentPage === totalPages || filtered.length === 0;
            
            // Style disabled buttons
            [prevBtn, nextBtn].forEach(btn => {
                if(btn.disabled) {
                    btn.classList.add('opacity-50', 'cursor-not-allowed');
                    btn.classList.remove('hover:border-amber-400', 'hover:text-amber-700');
                } else {
                    btn.classList.remove('opacity-50', 'cursor-not-allowed');
                    btn.classList.add('hover:border-amber-400', 'hover:text-amber-700');
                }
            });
        }

        // --- 5. Listeners ---

        document.getElementById('searchInput').addEventListener('input', (e) => {
            searchQuery = e.target.value.trim();
            currentPage = 1;
            updateCategoryDescription();
            render();
        });

        document.getElementById('prevBtn').addEventListener('click', () => {
            if (currentPage > 1) {
                currentPage--;
                render();
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }
        });

        document.getElementById('nextBtn').addEventListener('click', () => {
            const filtered = filterData();
            const totalPages = Math.ceil(filtered.length / itemsPerPage);
            if (currentPage < totalPages) {
                currentPage++;
                render();
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }
        });

        // Initialize
        createCategoryTabs();
        render();

    </script>
</body>
</html>


